- hosts: all
  become: yes
  become_method: sudo
  tasks:
    - name: "Install apt packages"
      apt:
        state: present
        name:
          - apt-transport-https
          - autofs
          - bmon
          - build-essential
          - ca-certificates
          - curl
          - debconf-utils
          - fio
          - git
          - gnupg-agent
          - htop
          - hwloc
          - inotify-tools
          - iotop
          - iptables-persistent  # make changes for consul DNS persistent
          - jq
          - lm-sensors
          - net-tools
          - nmap
          - parallel
          - pigz
          - postgresql-client-12
          - python3-pip
          - python3-venv
          - rsync
          - screen
          - software-properties-common
          - sqlite3
          - sshpass
          - tree
          - vim
          - webhook
          - wget
          - zip
        update_cache: yes
        cache_valid_time: 1800

- name: Include ingest Docker playbook
  import_playbook: playbook-ingest-docker.yml

- hosts: all
  become: yes
  become_method: sudo
  roles:
    - tsdata
    - seaflowpy
    - popcycle

- hosts: all
  become: yes
  become_method: sudo
  roles:
    - caddy
    - consul
    - consul-template
    - nomad
    - vault
    - grafana
    - timescaledb
    - minio
    - mc
    - hashicorp-realtime-dashboard
